version: '3'
services:
  python:
    image: python
    build: ./code
    command: echo "this is a test"
    volumes:
      - ./code/:/usr/src/app
    ports:
      - 5001:5001
  tensorflow:
    image: tensorflow/tensorflow:1.4.0-gpu
    #image: nvidia/cuda8.0      #Hier muss irgendwie noch das nvidia Image mit dabzu da sonst kein Cuda vorhanden
    build: ./code
    command: python test-tensorflow.py
    volumes:
      - ./code/:/usr/src/app
    ports:
      - 5002:5002
  nvsmi:
    image: ubuntu:16.04
    runtime: nvidia
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
    command: nvidia-smi